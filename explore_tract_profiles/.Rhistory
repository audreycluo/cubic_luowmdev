color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3)
tractprofiles_plot
plot_dist_to_gm <- function(tract, age_effect_df1, age_effect_df2, custom_color1, custom_color2) {
df1 <- age_effect_df1 %>% filter(tractID == tract) %>% arrange(nodeID) # HCPD
df2 <- age_effect_df2 %>% filter(tractID == tract) %>% arrange(nodeID)  # HBN
df <- rbind(df1, df2)
if (str_detect(tract, "Inferior")) {
plot <- ggplot(data = df, aes(x = dist_to_gm, y = s_age.delta.adj.rsq_signed, colour = Dataset, fill = Dataset)) +
geom_point(shape = 21, size=3, alpha = 0.8) +
geom_smooth(data = df, method='lm', se=TRUE, aes(fill=Dataset), alpha = 0.3) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) + theme_classic() +
stat_cor(method = "pearson", aes(label = ..r.label.., color = Dataset), size = 8, label.x.npc = 0.6,label.y.npc = 0.2) +
theme(legend.position = "none", legend.text=element_text(size=16), legend.title=element_text(size=16),
axis.title.y = element_blank(),
axis.text.x = element_text(size=16),
axis.text.y = element_text(size=16),
plot.title = element_text(size=16, hjust=0.5),
plot.margin = unit(c(0.2, 0.2, 0.2, -0.8), "cm")) + labs(title = tract) + xlab("Distance to Cortex (mm)")
} else if (str_detect(tract, "Anterior Thalamic")){
plot <- ggplot(data = df, aes(x = dist_to_gm, y = s_age.delta.adj.rsq_signed, colour = Dataset, fill = Dataset)) +
geom_point(shape = 21, size=3, alpha = 0.8) +
geom_smooth(data = df, method='lm', se=TRUE, aes(fill=Dataset), alpha = 0.3) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) + theme_classic() +
stat_cor(method = "pearson", aes(label = ..r.label.., color = Dataset), size = 8, label.x.npc = 0.01,label.y.npc = 1) +
theme(legend.position = "none", legend.text=element_text(size=16), legend.title=element_text(size=16),
axis.title.y = element_blank(),
axis.text.x = element_text(size=16),
axis.text.y = element_text(size=16),
plot.title = element_text(size=16, hjust=0.5)) + labs(title = tract) + xlab("Distance to Cortex (mm)")
}else {
plot <- ggplot(data = df, aes(x = dist_to_gm, y = s_age.delta.adj.rsq_signed, colour = Dataset, fill = Dataset)) +
geom_point(shape = 21, size=3, alpha = 0.8) +
geom_smooth(data = df, method='lm', se=TRUE, aes(fill=Dataset), alpha = 0.3) +
stat_cor(method = "pearson", aes(label = ..r.label.., color = Dataset), size = 8,  label.x.npc = 0.55,label.y.npc = 0.2) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) + theme_classic() +
theme(legend.position = "none", legend.text=element_text(size=16),legend.title=element_text(size=16),
axis.title.y = element_blank(),
axis.text.x = element_text(size=16),
axis.text.y = element_text(size=16),
plot.title = element_text(size=16, hjust=0.5)) + labs(title = tract) + xlab("Distance to Cortex (mm)")
}
return(plot)
}
dist_plot <- lapply(unique(bilat_gm_dist_toplot_HCPD$tractID), plot_dist_to_gm,
age_effect_df1 = bilat_gm_dist_toplot_HCPD,
age_effect_df2 = bilat_gm_dist_toplot_HBN,
custom_color1 = "#6bd4e0", custom_color2 = "#fea489")
names(dist_plot) <- unique(bilat_gm_dist_toplot_HCPD$tractID)
list_figures=dist_plot
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation`,
list_figures$`Cingulum Cingulate`,
list_figures$`Inferior Fronto-occipital Fasciculus`,
list_figures$`Inferior Longitudinal Fasciculus`,
list_figures$`Superior Longitudinal Fasciculus`,
list_figures_nulls$`Anterior Thalamic Radiation`,
list_figures_nulls$`Cingulum Cingulate`,
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`,
list_figures_nulls$`Inferior Longitudinal Fasciculus`,
list_figures_nulls$`Superior Longitudinal Fasciculus`,
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus`,
list_figures$`Uncinate Fasciculus`,
list_figures_nulls$`Arcuate Fasciculus`,
list_figures_nulls$`Uncinate Fasciculus`, ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`, list_figures$`Forceps Minor`,
list_figures_nulls$`Forceps Major`, list_figures_nulls$`Forceps Minor`,
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract`, list_figures$`Posterior Arcuate`,
list_figures$`Vertical Occipital Fasciculus`,
list_figures_nulls$`Corticospinal Tract`, list_figures_nulls$`Posterior Arcuate`,
list_figures_nulls$`Vertical Occipital Fasciculus`, common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3)
tractprofiles_plot
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab("expression("Age Effect ("*Delta*"Adjusted R"^2*")")"),
list_figures$`Anterior Thalamic Radiation` + ylab("expression("Age Effect ("*Delta*"Adjusted R"^2*")")")
list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")")
list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")")
list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")")
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate`,
list_figures$`Inferior Fronto-occipital Fasciculus`,
list_figures$`Inferior Longitudinal Fasciculus`,
list_figures$`Superior Longitudinal Fasciculus`,
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`,
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`,
list_figures_nulls$`Inferior Longitudinal Fasciculus`,
list_figures_nulls$`Superior Longitudinal Fasciculus`,
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`,
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`, ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`, list_figures$`Forceps Minor`,
list_figures_nulls$`Forceps Major`, list_figures_nulls$`Forceps Minor`,
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`,
list_figures$`Vertical Occipital Fasciculus`,
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"), list_figures_nulls$`Posterior Arcuate`,
list_figures_nulls$`Vertical Occipital Fasciculus`, common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3)
tractprofiles_plot
list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")"))
plot_dist_to_gm <- function(tract, age_effect_df1, age_effect_df2, custom_color1, custom_color2) {
df1 <- age_effect_df1 %>% filter(tractID == tract) %>% arrange(nodeID) # HCPD
df2 <- age_effect_df2 %>% filter(tractID == tract) %>% arrange(nodeID)  # HBN
df <- rbind(df1, df2)
if (str_detect(tract, "Inferior")) {
plot <- ggplot(data = df, aes(x = dist_to_gm, y = s_age.delta.adj.rsq_signed, colour = Dataset, fill = Dataset)) +
geom_point(shape = 21, size=3, alpha = 0.8) +
geom_smooth(data = df, method='lm', se=TRUE, aes(fill=Dataset), alpha = 0.3) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) + theme_classic() +
stat_cor(method = "pearson", aes(label = ..r.label.., color = Dataset), size = 8, label.x.npc = 0.6,label.y.npc = 0.2) +
theme(legend.position = "none", legend.text=element_text(size=16), legend.title=element_text(size=16),
# axis.title.y = element_blank(),
axis.text.x = element_text(size=16),
axis.text.y = element_text(size=16),
plot.title = element_text(size=16, hjust=0.5),
plot.margin = unit(c(0.2, 0.2, 0.2, -0.8), "cm")) + labs(title = tract) + xlab("Distance to Cortex (mm)")
} else if (str_detect(tract, "Anterior Thalamic")){
plot <- ggplot(data = df, aes(x = dist_to_gm, y = s_age.delta.adj.rsq_signed, colour = Dataset, fill = Dataset)) +
geom_point(shape = 21, size=3, alpha = 0.8) +
geom_smooth(data = df, method='lm', se=TRUE, aes(fill=Dataset), alpha = 0.3) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) + theme_classic() +
stat_cor(method = "pearson", aes(label = ..r.label.., color = Dataset), size = 8, label.x.npc = 0.01,label.y.npc = 1) +
theme(legend.position = "none", legend.text=element_text(size=16), legend.title=element_text(size=16),
#axis.title.y = element_blank(),
axis.text.x = element_text(size=16),
axis.text.y = element_text(size=16),
plot.title = element_text(size=16, hjust=0.5)) + labs(title = tract) + xlab("Distance to Cortex (mm)")
}else {
plot <- ggplot(data = df, aes(x = dist_to_gm, y = s_age.delta.adj.rsq_signed, colour = Dataset, fill = Dataset)) +
geom_point(shape = 21, size=3, alpha = 0.8) +
geom_smooth(data = df, method='lm', se=TRUE, aes(fill=Dataset), alpha = 0.3) +
stat_cor(method = "pearson", aes(label = ..r.label.., color = Dataset), size = 8,  label.x.npc = 0.55,label.y.npc = 0.2) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) + theme_classic() +
theme(legend.position = "none", legend.text=element_text(size=16),legend.title=element_text(size=16),
#axis.title.y = element_blank(),
axis.text.x = element_text(size=16),
axis.text.y = element_text(size=16),
plot.title = element_text(size=16, hjust=0.5)) + labs(title = tract) + xlab("Distance to Cortex (mm)")
}
return(plot)
}
dist_plot <- lapply(unique(bilat_gm_dist_toplot_HCPD$tractID), plot_dist_to_gm,
age_effect_df1 = bilat_gm_dist_toplot_HCPD,
age_effect_df2 = bilat_gm_dist_toplot_HBN,
custom_color1 = "#6bd4e0", custom_color2 = "#fea489")
names(dist_plot) <- unique(bilat_gm_dist_toplot_HCPD$tractID)
list_figures=dist_plot
list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")"))
plot_nulls <- function(tract, custom_color1, custom_color2) {
block_shuffle20 <- rbind(block_shuffle20_HCPD[[tract]], block_shuffle20_HBN[[tract]])
#stat_HCPD <- unique(block_shuffle20$stat[which(block_shuffle20$dataset == "HCPD")])
#stat_HBN <- unique(block_shuffle20$stat[which(block_shuffle20$dataset == "HBN")])
pval_HCPD <- round(pvals_HCPD[[tract]], 2)
pval_HBN <- round(pvals_HBN[[tract]], 2)
plot <- ggplot(block_shuffle20, aes(x = value, colour = dataset, fill = dataset)) +
geom_histogram(alpha = 0.5) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
geom_segment(aes(x=stat, xend = stat, y = 0, yend = 1900, color = dataset, group=dataset), size = 2) +
annotate("text", x=-0.6, y=900, label = substitute(atop(italic(p)[FDR] == pval_value), list(pval_value = pval_HBN)), hjust=0.5, vjust= -0.5, size=8, colour="#e07d5f") +
annotate("text", x=-0.6, y=500, label = substitute(atop(italic(p)[FDR] == pval_value), list(pval_value = pval_HCPD)), hjust=0.5, vjust= -0.5, size=8, colour="#38becd") +
theme_classic() +
theme(legend.position = "none",
#axis.title.y = element_blank())+
coord_cartesian(ylim = c(0, 2000), xlim=c(-1,1.15)) + xlab("Pearson Correlation")
return(plot)
plot_nulls <- function(tract, custom_color1, custom_color2) {
block_shuffle20 <- rbind(block_shuffle20_HCPD[[tract]], block_shuffle20_HBN[[tract]])
#stat_HCPD <- unique(block_shuffle20$stat[which(block_shuffle20$dataset == "HCPD")])
#stat_HBN <- unique(block_shuffle20$stat[which(block_shuffle20$dataset == "HBN")])
pval_HCPD <- round(pvals_HCPD[[tract]], 2)
pval_HBN <- round(pvals_HBN[[tract]], 2)
plot <- ggplot(block_shuffle20, aes(x = value, colour = dataset, fill = dataset)) +
geom_histogram(alpha = 0.5) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
geom_segment(aes(x=stat, xend = stat, y = 0, yend = 1900, color = dataset, group=dataset), size = 2) +
annotate("text", x=-0.6, y=900, label = substitute(atop(italic(p)[FDR] == pval_value), list(pval_value = pval_HBN)), hjust=0.5, vjust= -0.5, size=8, colour="#e07d5f") +
annotate("text", x=-0.6, y=500, label = substitute(atop(italic(p)[FDR] == pval_value), list(pval_value = pval_HCPD)), hjust=0.5, vjust= -0.5, size=8, colour="#38becd") +
theme_classic() +
theme(legend.position = "none"
)+
coord_cartesian(ylim = c(0, 2000), xlim=c(-1,1.15)) + xlab("Pearson Correlation")
return(plot)
}
block_shuffle_nulls <- lapply(unique(gam_age_md_bilat_HCPD$tractID), plot_nulls, custom_color1 = "#6bd4e0", custom_color2 = "#fea489")
names(block_shuffle_nulls) <- unique(gam_age_md_bilat_HCPD$tractID)
list_figures_nulls=block_shuffle_nulls
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate`,
list_figures$`Inferior Fronto-occipital Fasciculus`,
list_figures$`Inferior Longitudinal Fasciculus`,
list_figures$`Superior Longitudinal Fasciculus`,
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`,
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`,
list_figures_nulls$`Inferior Longitudinal Fasciculus`,
list_figures_nulls$`Superior Longitudinal Fasciculus`,
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`,
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`, ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`, list_figures$`Forceps Minor`,
list_figures_nulls$`Forceps Major`, list_figures_nulls$`Forceps Minor`,
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`,
list_figures$`Vertical Occipital Fasciculus`,
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"), list_figures_nulls$`Posterior Arcuate`,
list_figures_nulls$`Vertical Occipital Fasciculus`, common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3)
tractprofiles_plot
list_figures$`Cingulum Cingulate` + theme(axis.title.y = element_blank())
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate` + theme(axis.title.y = element_blank()),
list_figures$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()), ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures$`Forceps Minor`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Minor`+ theme(axis.title.y = element_blank()),
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"),
list_figures_nulls$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()), common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3)
tractprofiles_plot
arrange_by_orientation_nulls <- function(list_figures, list_figures_nulls, title) {
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate` + theme(axis.title.y = element_blank()),
list_figures$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()), ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures$`Forceps Minor`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Minor`+ theme(axis.title.y = element_blank()),
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"),
list_figures_nulls$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()), common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3)
tractprofiles_plot_final <- annotate_figure(tractprofiles_plot, top = text_grob(title,
color = "black", face = "italic", size = 20))
return(tractprofiles_plot_final)
}
dist_plot_oriented <- arrange_by_orientation_nulls(dist_plot, block_shuffle_nulls, "Association Between Geodesic Distance to Cortex and Age Effect")
dist_plot_oriented
dist_plot_oriented
mean(c(0.55,0.28,0.36,0.81,0.53,0.79,-0.2,0.85,0.78,-0.28))
mean(c(0.6,0.42,0.59,0.83,0.93,0.26,0.49,0.77,0.75,0.82,0.94))
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/dist_to_cortex.png", dist_plot_oriented,
width = 23, height = 20, units = "in")
arrange_by_orientation_nulls <- function(list_figures, list_figures_nulls, title) {
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate` + theme(axis.title.y = element_blank()),
list_figures$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()), ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures$`Forceps Minor`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Minor`+ theme(axis.title.y = element_blank()),
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"),
list_figures_nulls$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()), common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3) bgcolor("white")
arrange_by_orientation_nulls <- function(list_figures, list_figures_nulls, title) {
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate` + theme(axis.title.y = element_blank()),
list_figures$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()), ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures$`Forceps Minor`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Minor`+ theme(axis.title.y = element_blank()),
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"),
list_figures_nulls$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()), common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3) + bgcolor("white")
tractprofiles_plot_final <- annotate_figure(tractprofiles_plot, top = text_grob(title,
color = "black", face = "italic", size = 20))
return(tractprofiles_plot_final)
}
dist_plot <- lapply(unique(bilat_gm_dist_toplot_HCPD$tractID), plot_dist_to_gm,
age_effect_df1 = bilat_gm_dist_toplot_HCPD,
age_effect_df2 = bilat_gm_dist_toplot_HBN,
custom_color1 = "#6bd4e0", custom_color2 = "#fea489")
names(dist_plot) <- unique(bilat_gm_dist_toplot_HCPD$tractID)
dist_plot_oriented <- arrange_by_orientation_nulls(dist_plot, block_shuffle_nulls, "Association Between Geodesic Distance to Cortex and Age Effect")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/dist_to_cortex.png", dist_plot_oriented,
width = 23, height = 20, units = "in")
plot_nulls <- function(tract, custom_color1, custom_color2) {
block_shuffle20 <- rbind(block_shuffle20_HCPD[[tract]], block_shuffle20_HBN[[tract]])
#stat_HCPD <- unique(block_shuffle20$stat[which(block_shuffle20$dataset == "HCPD")])
#stat_HBN <- unique(block_shuffle20$stat[which(block_shuffle20$dataset == "HBN")])
pval_HCPD <- round(pvals_HCPD[[tract]], 2)
pval_HBN <- round(pvals_HBN[[tract]], 2)
plot <- ggplot(block_shuffle20, aes(x = value, colour = dataset, fill = dataset)) +
geom_histogram(alpha = 0.7) +
scale_fill_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
scale_color_manual(values = c("HCPD" = custom_color1, "HBN" = custom_color2)) +
geom_segment(aes(x=stat, xend = stat, y = 0, yend = 1900, color = dataset, group=dataset), size = 2) +
annotate("text", x=-0.6, y=900, label = substitute(atop(italic(p)[FDR] == pval_value), list(pval_value = pval_HBN)), hjust=0.5, vjust= -0.5, size=8, colour="#e07d5f") +
annotate("text", x=-0.6, y=500, label = substitute(atop(italic(p)[FDR] == pval_value), list(pval_value = pval_HCPD)), hjust=0.5, vjust= -0.5, size=8, colour="#38becd") +
theme_classic() +
theme(legend.position = "none"
)+
coord_cartesian(ylim = c(0, 2000), xlim=c(-1,1.15)) + xlab("Pearson Correlation")
return(plot)
}
# arrange by AP, AP_frontal_temporal, RL (forceps), and SI
x.grob <- textGrob("Spatial Autocorrelation Preserving Null Distribution of Pearson Correlations",
gp=gpar(col="black", fontsize=14))
y.grob <- textGrob("Frequency",
gp=gpar(col="black", fontsize=14), rot=90)
space.grob <- textGrob(" ",
gp=gpar(col="black", fontsize=28), rot=90)
block_shuffle_nulls <- lapply(unique(gam_age_md_bilat_HCPD$tractID), plot_nulls, custom_color1 = "#6bd4e0", custom_color2 = "#fea489")
names(block_shuffle_nulls) <- unique(gam_age_md_bilat_HCPD$tractID)
dist_plot_oriented <- arrange_by_orientation_nulls(dist_plot, block_shuffle_nulls, "Association Between Geodesic Distance to Cortex and Age Effect")
dist_plot_oriented <- arrange_by_orientation_nulls(dist_plot, block_shuffle_nulls, "Association Between Geodesic Distance to Cortex and Age Effect")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/dist_to_cortex.png", dist_plot_oriented,
width = 23, height = 20, units = "in")
dist_plot_oriented
devtraj_zeroed_md_HCPD <- lapply(unique(nodewise_smoothfits_md_HCPD$tractID), plot_nodes_zeroed, df = nodewise_smoothfits_md_HCPD, scalar = "MD", -0.00008, 0.00007)
names(devtraj_zeroed_md_HCPD) <- unique(nodewise_smoothfits_md_HCPD$tractID)
devtraj_zeroed_md_plots_HCPD <- arrange_by_orientation_traj(devtraj_zeroed_md_HCPD, "HCP-D")
devtraj_zeroed_md_HBN <- lapply(unique(nodewise_smoothfits_md_HBN$tractID), plot_nodes_zeroed, df = nodewise_smoothfits_md_HBN, scalar = "MD", -0.00008, 0.00007)
names(devtraj_zeroed_md_HBN) <- unique(nodewise_smoothfits_md_HBN$tractID)
devtraj_zeroed_md_plots_HBN <- arrange_by_orientation_traj(devtraj_zeroed_md_HBN, "HBN")
title <- arrangeGrob(zeroGrob(), title,
widths = unit(1, 'npc'),
heights = unit(c(2, 1), c('cm', 'npc')),
as.table = FALSE)
grid.arrange(gg1, gg2, top = title)
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/devtraj_zeroed_md_HCPD.png", grid.arrange(arrangeGrob(devtraj_zeroed_md_plots_HCPD, left = y.grob, bottom = x.grob, right = space.grob)), width = 18, height = 20, units = "in")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/devtraj_zeroed_md_HBN.png", grid.arrange(arrangeGrob(devtraj_zeroed_md_plots_HBN, left = y.grob, bottom = x.grob, right = space.grob)), width = 18, height = 20, units = "in")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/devtraj_zeroed_md_HCPD.png", grid.arrange(arrangeGrob(devtraj_zeroed_md_plots_HCPD, left = y.grob, bottom = x.grob, right = space.grob)), width = 15, height = 20, units = "in")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/devtraj_zeroed_md_HBN.png", grid.arrange(arrangeGrob(devtraj_zeroed_md_plots_HBN, left = y.grob, bottom = x.grob, right = space.grob)), width = 15, height = 20, units = "in")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/devtraj_zeroed_md_HCPD.png", grid.arrange(arrangeGrob(devtraj_zeroed_md_plots_HCPD, left = y.grob, bottom = x.grob, right = space.grob)), width = 18, height = 20, units = "in")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/devtraj_zeroed_md_HBN.png", grid.arrange(arrangeGrob(devtraj_zeroed_md_plots_HBN, left = y.grob, bottom = x.grob, right = space.grob)), width = 18, height = 20, units = "in")
arrange_by_orientation_nulls <- function(list_figures, list_figures_nulls, title) {
AP_plots <- ggarrange(list_figures$`Anterior Thalamic Radiation` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Cingulum Cingulate` + theme(axis.title.y = element_blank()),
list_figures$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Anterior Thalamic Radiation`+ ylab("Frequency"),
list_figures_nulls$`Cingulum Cingulate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Fronto-occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Inferior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Superior Longitudinal Fasciculus`+ theme(axis.title.y = element_blank()),
ncol=5, nrow = 2, heights = c(1, 0.7))
AP_plots_final <- annotate_figure(AP_plots, top = text_grob("Anterior - Posterior",
color = "black", face = "bold", size = 16))
AP_frontotemp_plots <- ggarrange(list_figures$`Arcuate Fasciculus` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")),
list_figures$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Arcuate Fasciculus`+ ylab("Frequency"),
list_figures_nulls$`Uncinate Fasciculus`+ theme(axis.title.y = element_blank()), ncol=2, nrow = 2, heights = c(1, 0.7))
AP_frontotemp_plots_final <- annotate_figure(AP_frontotemp_plots, top = text_grob("Anterior - Posterior (Frontal - Temporal)",
color = "black", face = "bold", size = 16))
RL_plots <- ggarrange(list_figures$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures$`Forceps Minor`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Major`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Forceps Minor`+ theme(axis.title.y = element_blank()),
ncol=2, nrow = 2, heights = c(1, 0.7))
RL_plots_final <- annotate_figure(RL_plots, top = text_grob("Right - Left",
color = "black", face = "bold", size = 16))
SI_plots <- ggarrange(list_figures$`Corticospinal Tract` + ylab(expression("Age Effect ("*Delta*"Adjusted R"^2*")")), list_figures$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Corticospinal Tract` + ylab("Frequency"),
list_figures_nulls$`Posterior Arcuate`+ theme(axis.title.y = element_blank()),
list_figures_nulls$`Vertical Occipital Fasciculus`+ theme(axis.title.y = element_blank()), common.legend=TRUE, legend=c("right"),
ncol=3, nrow = 2, heights = c(1, 0.7))
SI_plots_final <- annotate_figure(SI_plots, top = text_grob("Superior - Inferior",
color = "black", face = "bold", size = 16))
tractprofiles_plot <- ggarrange(AP_plots_final, ggarrange(AP_frontotemp_plots_final, RL_plots_final, ncol = 2), SI_plots_final, nrow = 3) + bgcolor("white")
tractprofiles_plot_final <- annotate_figure(tractprofiles_plot, top = text_grob(title,
color = "black", face = "italic", size = 20)) + bgcolor("white")
return(tractprofiles_plot_final)
}
dist_plot_oriented <- arrange_by_orientation_nulls(dist_plot, block_shuffle_nulls, "Association Between Geodesic Distance to Cortex and Age Effect")
dist_plot_oriented <- arrange_by_orientation_nulls(dist_plot, block_shuffle_nulls, "Association Between Geodesic Distance to Cortex and Age Effect")
ggsave("/Users/audluo/PennLINC/luowm_local/output/tract_profiles_testing/both_datasets/dist_to_cortex.png", dist_plot_oriented,
width = 23, height = 20, units = "in")
